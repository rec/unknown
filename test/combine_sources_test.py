import unittest
from . import mocks
from unknown import combine_sources


class CombineSourcesTest(unittest.TestCase):
    def test_empty(self):
        combined = combine_sources.CombineSources(
            wave_open=mocks.MockWave, fade_frames=0)
        mocks.compare((), combined, self)

    def test_single(self):
        combined = combine_sources.CombineSources(
            'biramp.wav', wave_open=mocks.MockWave, fade_frames=0)
        mocks.compare(SINGLE, combined, self)

    def test_single_with_fade(self):
        combined = combine_sources.CombineSources(
            'biramp.wav', wave_open=mocks.MockWave, fade_frames=3)
        mocks.compare(SINGLE_WITH_FADE, combined, self)

    def test_double_without_fade(self):
        combined = combine_sources.CombineSources(
            'biramp.wav', 'biramp.wav',
            wave_open=mocks.MockWave, fade_frames=0)
        mocks.compare(DOUBLE_WITHOUT_FADE, combined, self)

    def test_double_with_fade(self):
        combined = combine_sources.CombineSources(
            'biramp.wav', 'biramp.wav',
            wave_open=mocks.MockWave, fade_frames=3)
        mocks.compare(DOUBLE_WITH_FADE, combined, self)

    def test_combine_without_fade(self):
        combined = combine_sources.CombineSources(
            'biramp.wav', 'biramp.wav', 'biramp2.wav',
            wave_open=mocks.MockWave, fade_frames=0)
        mocks.compare(COMBINE_WITHOUT_FADE, combined, self)

    def test_combine_with_fade(self):
        combined = combine_sources.CombineSources(
            'biramp.wav', 'biramp.wav', 'biramp2.wav',
            wave_open=mocks.MockWave)
        mocks.compare(COMBINE_WITH_FADE, combined, self)


SINGLE = (
    (0x0000, 0xffff),
    (0x1000, 0xefff),
    (0x2000, 0xdfff),
    (0x3000, 0xcfff),
    (0x4000, 0xbfff),
    (0x5000, 0xafff),
    (0x6000, 0x9fff),
    (0x7000, 0x8fff),
    (0x8000, 0x7fff),
)

SINGLE_WITH_FADE = (
    (0x0000, 0x0000),
    (0x0555, 0x5000),
    (0x1555, 0x9555),
    (0x3000, 0xcfff),
    (0x4000, 0xbfff),
    (0x5000, 0xafff),
    (0x5800, 0x92aa),
    (0x4155, 0x53ff),
    (0x2000, 0x2000),
)
DOUBLE_WITHOUT_FADE = (
    (0x0000, 0xffff),
    (0x1000, 0xefff),
    (0x2000, 0xdfff),
    (0x3000, 0xcfff),
    (0x4000, 0xbfff),
    (0x5000, 0xafff),
    (0x6000, 0x9fff),
    (0x7000, 0x8fff),
    (0x8000, 0x7fff),
    (0x0000, 0xffff),
    (0x1000, 0xefff),
    (0x2000, 0xdfff),
    (0x3000, 0xcfff),
    (0x4000, 0xbfff),
    (0x5000, 0xafff),
    (0x6000, 0x9fff),
    (0x7000, 0x8fff),
    (0x8000, 0x7fff),
)
DOUBLE_WITH_FADE = (
    (0x0000, 0x0000),
    (0x0555, 0x5000),
    (0x1555, 0x9555),
    (0x3000, 0xcfff),
    (0x4000, 0xbfff),
    (0x5000, 0xafff),
    (0x5800, 0x12554),
    (0x46aa, 0xa7fe),
    (0x3555, 0x4000),
    (0x3000, 0xcfff),
    (0x4000, 0xbfff),
    (0x5000, 0xafff),
    (0x5800, 0x92aa),
    (0x4155, 0x53ff),
    (0x2000, 0x2000),
)

COMBINE_WITHOUT_FADE = (
    (0x0000, 0xffff),
    (0x1000, 0xefff),
    (0x2000, 0xdfff),
    (0x3000, 0xcfff),
    (0x4000, 0xbfff),
    (0x5000, 0xafff),
    (0x6000, 0x9fff),
    (0x7000, 0x8fff),
    (0x8000, 0x7fff),
    (0x0000, 0xffff),
    (0x1000, 0xefff),
    (0x2000, 0xdfff),
    (0x3000, 0xcfff),
    (0x4000, 0xbfff),
    (0x5000, 0xafff),
    (0x6000, 0x9fff),
    (0x7000, 0x8fff),
    (0x8000, 0x7fff),
    (0x8000, 0x7fff),
    (0x7000, 0x8fff),
    (0x6000, 0x9fff),
    (0x5000, 0xafff),
    (0x4000, 0xbfff),
    (0x4000, 0xbfff),
    (0x4000, 0xbfff),
    (0x4000, 0xbfff),
    (0x3000, 0xcfff),
    (0x2000, 0xdfff),
    (0x1000, 0xefff),
    (0x0000, 0xffff),
)

COMBINE_WITH_FADE = (
    (0x0000, 0x0000),
    (0x0555, 0x5000),
    (0x1555, 0x9555),
    (0x3000, 0xcfff),
    (0x4000, 0xbfff),
    (0x5000, 0xafff),
    (0x5800, 0x12554),
    (0x46aa, 0xa7fe),
    (0x3555, 0x4000),
    (0x3000, 0xcfff),
    (0x4000, 0xbfff),
    (0x5000, 0xafff),
    (0x5800, 0x12554),
    (0x66aa, 0xa7fe),
    (0x6000, 0x4000),
    (0x5000, 0xafff),
    (0x4000, 0xbfff),
    (0x4000, 0xbfff),
    (0x4000, 0xbfff),
    (0x4000, 0xbfff),
    (0x3000, 0xcfff),
    (0x1d55, 0xcd54),
    (0x0955, 0x8bff),
    (0x0000, 0x4000),
)
